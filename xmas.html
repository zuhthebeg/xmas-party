<html>
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" />
    <script
            src="https://code.jquery.com/jquery-2.2.4.min.js"
            integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
            crossorigin="anonymous"></script>
<style>
    body{
        background-image: url("https://c.pxhere.com/photos/e5/c5/background_balls_boxes_christmas_decorations_Christmas_gifts_close_up_decoration_gifts-1476099.jpg!d");
        background-size: cover;
    }
    h2{
        font-weight: bolder;
        font-size:30px;
        color:black;
        text-align: center;
        opacity: 1;
    }
    .box{
        background-color: white;
        opacity: 0.5;
        border:3px solid white;
        border-radius: 20px;
        margin:10px;
    }
    li{
        list-style: none;
        margin:10px;
    }
    .score {
        font-size:20px;
        font-weight: bolder;
        padding:10px;
    }
    #panel1{
        border:1px #000000 solid;
        line-height:200px;
        font-size:100px;
        width:200px;
        height:200px;
        text-align:center;
        vertical-align:middle;
    }
    #panel2{
        padding-left:10px;
        border:1px #000000 solid;
        width:200px;
        height:100px;
        text-align:left;
        vertical-align:middle;
        overflow-y: scroll;
    }
    ul {padding:0px}
</style>
</head>
<body>
<br><br>
<div class="box container">
    <h2>2019 Christmars Party!</h2>
</div>

<div class="row" style="margin-top:100px;">
    <div class="col text-center">
        <h3>Game 1 - 몸으로 말해요 </h3>
        <button class="btn btn-danger" onclick="genQuestion()"style="margin-top:30px;">
            랜덤 자음 생성! +3점
        </button>
        <div class="box"style="margin-top:50px;">
            <button class="btn btn-lg btn-outline-danger" readonly="readonly" id="question">
                시작
            </button>
        </div>
    </div>
    <div class="col text-center">
        <h3>Game 2 - 노래 듣고 제목 맞추기 </h3>
        <ol class="box">
            <li>카카오 미니에게 xx년도 노래 틀어줘</li>
            <li>노래가 나오면 제목을 먼저 맞추는사람에게 +3점</li>
        </ol>
    </div>

    <div class="col text-center">
        <h3>선물 랜덤 뽑기</h3>

        <div id="panel1" class="box"> 1
            <!-- 이곳에 숫자가 출력됩니다. -->
        </div>

        <div id="nav" >
            <input type="text" style="display:none" id="lab_total" value="6"><br/>
            <button id="btn_start" class="btn btn-success">시작</button>
            <button id="btn_stop" class="btn btn-primary">멈춤</button>
            <button id="btn_reset" class="btn btn-danger">리셋</button>
        </div>

        <div id="panel2" class="box">
            <!-- 이곳에 당첨번호가 출력됩니다. -->
        </div>
    </div>

    <div class="col text-center" style="padding-right: 80px;">
        <h3>점수판 </h3>
        <ul class="box">
            <li><button class="btn btn-sm btn-danger" onclick="gotPoint('.s1',-3)">-3</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s1',-2)">-2</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s1',-1)">-1</button> 용훈 <button class="btn btn-sm btn-success" onclick="gotPoint('.s1',1)">+1</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s1',2)">+2</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s1',3)">+3</button><span class="score s1">0</span></li>
            <li><button class="btn btn-sm btn-danger" onclick="gotPoint('.s2',-3)">-3</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s2',-2)">-2</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s2',-1)">-1</button> 축우 <button class="btn btn-sm btn-success" onclick="gotPoint('.s2',1)">+1</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s2',2)">+2</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s2',3)">+3</button><span class="score s2">0</span></li>
            <li><button class="btn btn-sm btn-danger" onclick="gotPoint('.s3',-3)">-3</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s3',-2)">-2</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s3',-1)">-1</button> 민선 <button class="btn btn-sm btn-success" onclick="gotPoint('.s3',1)">+1</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s3',2)">+2</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s3',3)">+3</button><span class="score s3">0</span></li>
            <li><button class="btn btn-sm btn-danger" onclick="gotPoint('.s4',-3)">-3</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s4',-2)">-2</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s4',-1)">-1</button> 명훈 <button class="btn btn-sm btn-success" onclick="gotPoint('.s4',1)">+1</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s4',2)">+2</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s4',3)">+3</button><span class="score s4">0</span></li>
            <li><button class="btn btn-sm btn-danger" onclick="gotPoint('.s5',-3)">-3</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s5',-2)">-2</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s5',-1)">-1</button> 재욱 <button class="btn btn-sm btn-success" onclick="gotPoint('.s5',1)">+1</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s5',2)">+2</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s5',3)">+3</button><span class="score s5">0</span></li>
            <li><button class="btn btn-sm btn-danger" onclick="gotPoint('.s6',-3)">-3</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s6',-2)">-2</button> <button class="btn btn-sm btn-danger" onclick="gotPoint('.s6',-1)">-1</button> 아량 <button class="btn btn-sm btn-success" onclick="gotPoint('.s6',1)">+1</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s6',2)">+2</button> <button class="btn btn-sm btn-success" onclick="gotPoint('.s6',3)">+3</button><span class="score s6">0</span></li>
        </ul>
        <button id="score_reset" class="btn btn-danger" onclick="$('.score').html(0)">리셋</button>

    </div>


</div>
<script>
    function setOrder() {
        var list = document.querySelector("ul");
        var items = list.querySelectorAll("li");
        var sortedList = Array.from(items).sort(function(a, b) {
            console.log($(a).find('.score'))
            var c = parseInt($(a).find('.score').html()),
                d = parseInt($(b).find('.score').html());
            console.log(c,d)
            return c > d ? -1 : c < d ? 1 : 0;
        });
        for (let item of sortedList) {
            list.appendChild(item);
        }
        console.log(sortedList)
    }
    function gotPoint(clazz, point) {
        if(confirm(point > 0 ? 'ㅊㅋㅊㅋ' : 'ㅉㅉㅉ')) {
            $(clazz).html(parseInt($(clazz).html())+point);
            setOrder();
        }
    }
    function genQuestion(){
        console.log(randNum())
        $('#question').html(randNum());
    }

    function randNum() {
        let ALPHA = ['ㄱ','ㄴ','ㄷ','ㄹ','ㅁ','ㅂ','ㅅ','ㅇ','ㅈ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'];
        let rN = '';
        for (let i = 0; i < 2; i++) {
            let randTnum = Math.floor(Math.random() * ALPHA.length);
            rN += ALPHA[randTnum];
        }
        return rN;
    }

    var panel1;
    var nTimerID;
    var labTotal;
    var nTotalMember;
    var resultPanelCnt = 0;
    window.onload=function(){
        // 요소 초기화 실행.
        this.init();
        // 이벤트 초기화 실행.
        this.initEventListener();
    }

    // 요소 초기화.
    function init(){
        // 숫자가 출력될 #panel1을 찾아 전역변수에 담아둡니다.
        this.panel1 = document.getElementById("panel1");
        this.nTimerID = 0;
        // 참여인원 정보가 입력된 패널을 찾아 전역변수에 담아둡니다.
        this.labTotal = document.getElementById("lab_total");
        this.nTotalMember = 0;

    }

    // 이벤트 초기화.
    function initEventListener()
    {
        var btnStart = document.getElementById("btn_start");
        btnStart.addEventListener("click", function(){
                startTimer();
            }
            ,false);

        var btnStop = document.getElementById("btn_stop");
        btnStop.addEventListener("click",function(){
            stopTimer();
        },false);

        var btnReset = document.getElementById("btn_reset");
        btnReset.addEventListener("click",function(){
            resetTimer();
        },false);

    }
    // 0.2초에 한번씩 createNumber()함수를 실행시켜 줍니다.
    function startTimer()
    {
        if(this.nTimerID==0){
            //입력된 참여인원수를 구해옵니다.
            this.nTotalMember = Number(this.labTotal.value);
            // 타이머 시작시 #panel1의 글자색을 초기화 시켜 줍니다.
            this.resetPanelStyle();
            this.nTimerID = setInterval(this.createNumber,20);
        }
    }

    // createNumber()함수 호출하는 타이머를 멈춥니다.
    function stopTimer(){
        if(this.nTimerID){
            clearInterval(this.nTimerID);
            this.nTimerID = 0;
            //출력효과 추가.
            this.showWinner();

            //당첨번호를 panel2에 출력
            this.showResult();
        }
    }

    // 리셋하면 당첨자 목록을 삭제하고, 당첨자 순서 초기화
    function resetTimer(){

        var resultPanel = document.getElementById("panel2");
        resultPanel.innerHTML = "";

        //당첨자 순서 초기화
        resultPanelCnt = 0;
    }

    // 랜덤하게 1에서 참여인원수 사이의 숫자를 만들어 냅니다.
    function createNumber(){
        var nNum = 1+Math.floor(Math.random()*this.nTotalMember);
        //만들어진 숫자를 innerHTML에 대입시켜 줍니다.
        this.panel1.innerHTML = nNum;
        // 폰트 크기를 100~200으로 랜덤하게 설정해줍니다.
        this.panel1.style.fontSize = 100+(Math.random()*100)+"px";
        // 색상을 랜덤하게 설정해줍니다.
        this.panel1.style.color = "#" + (parseInt(Math.random() * 0xffffff)).toString(16);
    }

    // 출력효과 추가.
    function showWinner(){
        // 당첨자를 알리기 위해서 #panel1의 글자색과 크기를 변경시켜줍니다.
        this.panel1.style.color = "#ff0000";
        this.panel1.style.fontSize = "200px";
    }

    // 출력패널의 스타일을 초기화 시켜준다.
    function resetPanelStyle()
    {
        this.panel1.style.color = "#000000";
    }

    //당첨 번호를 리스트 형태로 쌓아둔다.
    function showResult(){

        var span        = document.createElement("span");
        var Panel1      = document.getElementById("panel1");
        var resultPanel = document.getElementById("panel2");

        resultPanelCnt++;

        console.log(resultPanelCnt + " 번째 당첨번호 : " + Panel1.innerHTML);

        span.style.fontSize = "20px";
        span.style.color    = "steelblue";
        span.innerHTML      = "<font color='black'>" + resultPanelCnt + ". </font>" + Panel1.innerHTML;

        resultPanel.appendChild(span);
        resultPanel.appendChild(document.createElement("br"));

        //console.log(" resultPanel.clientHeight : " + resultPanel.clientHeight);
        console.log(" resultPanel.offsetHeight : " + resultPanel.offsetHeight + " || resultPanel.scrollHeight :  " + resultPanel.scrollHeight);

        //만약 당첨자의 목록이 panel2를 overflow 하면 아래로 자동 스크롤하시오.
        if(resultPanel.offsetHeight < resultPanel.scrollHeight){
            //console.log("내용이 많아졌다.");
            resultPanel.scrollTop = resultPanel.scrollHeight - resultPanel.offsetHeight;
        }

    }
</script>
</body>
</html>
